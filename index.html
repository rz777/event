<!DOCTYPE html>
<html lang="en">
<head>
<title>Zulu Gaming Christmas Event!</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="scholars.json"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"> 
    </head>

<body>	
	<center><div id='Axie'><img src="zuluxmassmall.png" style="width:50%;height:auto;"></a></div></center>
	<h1><font color=#FFFFFF><b>Zulu Gaming - Christmas Event!</b></h1>
		<h2><font color=#FFFFFF><b>Everyone gets more SLP for farming all Christmas! :-)</b></font></h2>
		<h3>&nbsp;</h3>
    <div class="ladder">
    	<ul id=ladderList>
    	</ul>
    	<div id="stats"></div>
    
    </div>



    <script>
    
    
    var total=0;


    getSlps(0);

    console.log(scholars[0].adress);
    
 
   
	function getSlps(index,callback){
		if(index == scholars.length){
			total=100000;
			$("#stats").append("<p></p>");
			$("#stats").append("<div id='prizeDiv'><font><p><b>Total SLP collected: "+(total)+" SLP</b></p><p><b>Total Bonus for everyone: "+(Math.round(total*0.0015*0.3))+" SLP</b></p><p><b>1st prize: </b>"+Math.round(total*0.015*0.3)+" SLP <br><b>2nd prize: </b>"+Math.round(total*0.01*0.3)+" SLP <br><b>3rd prize: </b>"+Math.round(total*0.005*0.3)+" SLP </p></font></div>");
			sortList();

			return;
		}else{

			$.getJSON('https://lunacia.skymavis.com/game-api/clients/'+scholars[index].adress+'/items/1', function (data) {
			  scholars[index].slp = data.blockchain_related.signature.amount-scholars[index].slpsnapshot;

			  total= total+ scholars[index].slp;
			  $("#ladderList").append("<li><font>"+scholars[index].name+" = "+ scholars[index].slp+"</font></li>");
			  getSlps(index+1);
			});
		}
	}

	 function Comparator(a, b) {
	   if (a.slp > b.slp) return -1;
	   if (a.slp < b.slp) return 1;
	   return 0;
	 }

	function sortList(){
		var text='';
		var sortedList = scholars.sort(Comparator);
		for(var i = 0; i<sortedList.length;i++){
			if(i<3){
				text=text+"<li class='winners'><font>"+sortedList[i].name+" = "+sortedList[i].slp+"</font></li>"
			}else{
				text=text+"<li><font>"+sortedList[i].name+" = "+sortedList[i].slp+"</font></li>"
			}		
		}
		$("#ladderList").html(text);
		console.log(sortedList);
	}





    </script>
    
</body>
</html>
